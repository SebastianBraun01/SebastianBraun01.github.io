<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/led_matrix.css">
  <title>LED-Matrix | Sebastian Braun</title>
</head>

<body>
  <!-- Navbar mit Logo -->
  <header>
    <div id="logo-container">
      <img src="../img/logo_hell.png" height="65" alt="Logo" >
    </div>

    <nav>
      <ul>
        <li class="nav-link"><a class="link-text" href="../index.html">home();</a></li>
        <li class="nav-link"><a class="link-text" href="../pages/√ºbermich.html">getInfo();</a></li>
        <li class="nav-link"><a class="link-text" href="../pages/template.html">template();</a></li>
        <li class="nav-link"><a class="link-text" href="https://github.com/SebastianBraun01">github();</a></li>
      </ul>
    </nav>
  </header>
  

  <!-- Hauptseite -->
  <main>
    <section id="Titel">
      <h1>LED-Matrix</h1>
      <img src="" alt="Foto noch einf√ºgen">
    </section>

    <section id="Beschreibung">
      <p>Die LED Matrix geh√∂rt technisch gesehen, noch zu meinem anderen Projekt, der LED Beleuchtung, hat aber mitlerweile eine solche komplexit√§t erreicht, dass es sinnvol ist sie hier nochmal ausf√ºhrlich zu beschreiben. Die LED Matrix wird ein tolles Gimmik f√ºr unseren Partykeller, unzwar ein riesiger Audio Spektrograph. Die Steuerung der Matrix wird dann mit dem Mischpult unserer Surround-Anlage verbunden und zeigt in verschiedenen Formen und Farben das Frequenzspektrum der Musik.</p>
      <br>
      <br>


      <p>Matrix aufbau erkl√§ren</p>


      <br>
      <br>
      <img src="" alt="Bild der CAD Konstruktion">
      <img src="" alt="Bild der Verkabelung">
      <br>
      <br>
      <p>Nun zur Steuerung, dem komplizierten Teil. Urspr√ºnglich ich die LED Matrix auch nur mit einem normalen Arduino betreiben. Daf√ºr habe ich von Adafruit eine FFT Bibliothek gefunden. Der "Fast Fourier Transform (FFT)" ist ein mathematischer Algorythmus, mit dem ein Computer oder Mikrocontroller aus den Messpunkten des Zeitsignal der Musik ein Frequenzspektrum berechnen kann, f√ºr mich also die charakteristischen Balken, die die Anteile hohen und tiefen T√∂ne in der Musik anzeigen (auf den FFT Algorythmus m√∂chte ich in einem anderen Artikel noch genauer eingehen, die Projektbeschreibung wird hier so schon noch lang genug).</p>
      <br>
      <br>
      <p>Der Arduino sollte also die Messpunkte mit dem integrierten AD Wandler aufnehmen, diese mit dem FFT Algorythmus verarbeiten und das Ergebnis auf der Matrix ausgeben. Daf√ºr habe ich einen kleinen Prototypen gebaut. Dieser hat auch perfekt funktioniert.</p>
      <br>
      <br>
      <video src="" muted preload ></video>
      <p>Video von Prototyp einf√ºgen</p>
      <br>
      <br>
      <p>Diese Herangehensweise hat nur einen Haken. Je gr√∂√üer die Matrix wird, desto langsamer wird die ganze Rechnerei im Mikrocontroller, weil die Berechnungen und das Ansteuern der Matrix zeit brauchen und nicht parallel ablaufen k√∂nnen. Mit diesem kleinen Prototypen funktioniert noch alles einwandfrei, aber wenn ich die Steuerung an die gro√üe Matrix h√§nge, wird das nur noch eine Diashow.</p>
      <br>
      <br>
      <p>Ein anderer Plan musste her und da bin ich auf FPGAs gekommen. Es gibt von Arduino n√§mlich den MKR Vidor 4000, ein Development Board auf dem ein Mikrocontroller (SAM21) und ein FPGA (Intel Cyclone 10) verbaut ist. Ein FPGA ist ideal f√ºr dieses Projekt, da ich alle Aufgaben (au√üer das samplen mit dem ADC) auf dem FPGA parallel betreiben und wie eine Pipeline behandeln kann und das mit einem noch viel h√∂hren Takt. Das ist vor allem f√ºr die Ansteuerung der Matrix wichtig, da ich jetzt nicht einen gro√üen Streifen ansteuern muss, der die Matrix bildet, sondern ich kann jetzt f√ºr jede einzelne Spalte der Matrix, einen seperaten Streifen benutzen und diese alle komplett parallel ansteuern und das mit bis zu 200MHz (ist ein bischen √ºbertrieben, aber m√∂glich üòé). Auf dem Arduino gibt es ein 24MHz Taktsignal f√ºr den FPGA, das hat bis jetzt f√ºr alles einwandfrei funktioniert.</p>
      <br>
      <br>
      <img src="" alt="Arduino MKR Vidor 4000">
      <br>
      <br>
      <p>Um den FPGA zu programmieren, benutze ich Verilog, ich bin zwar √ºber die Hochschule auch mit VHDL vertraut aber ich finde den Syntax von Verilog wesentlich besser und ich mag die N√§he zur C Programmiersprache. Ich habe das Programm f√ºr den FPGA auf mehrere Module aufgeteilt:</p>
      <br>
      <br>
      <ul>
        <li>npxl_treiber:     Treibermodul f√ºr die LED Streifen</li>
        <li>npxl_controller:  Liest Farbdaten ein und gibt sie √ºber die Streifen aus</li>
        <li>ROM:              Speichert momentan feste Farbmuster f√ºr die Balkenanzeige des FFT Outputs</li>
        <li>RAM:              Blockram als Zwischenspeicher f√ºr FFT Werte</li>
        <li>uart_rx:          UART Empf√§nger um ADC Daten vom Mikrocontroller zu empfangen</li>
        <li>FFT:              FFT Megafunktion (von Gisselquist, Link unten)</li>
        <li>spektrometer:     Top Modul f√ºr das FPGA programm, bindet alle ben√∂tigten Sub Module ein</li>
      </ul>
      <br>
      <br>
      <img src="" alt="Diagramm vom Programmaufbau">
      <br>
      <br>
      <p><!-- Beschreibungen der Module --></p>
    </section>

    <section id="Links">
      <a href="#">Projekt Repository</a>
      <a href="#">Gisselquist Seite</a>
      <a href="#">Adafruit seiten</a>
    </section>
  </main>
</body>
</html>
